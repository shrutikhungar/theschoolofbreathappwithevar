{"version":3,"sources":["index.tsx"],"names":["React","PureComponent","FlatList","Text","StyleSheet","View","Platform","TouchableOpacity","LinearGradient","adaptiveColor","setAlphaColor","Haptics","WheelPickerExpo","createRef","props","backgroundColor","selectedIndex","itemHeight","listHeight","data","index","items","length","flatListRef","current","scrollToIndex","animated","componentDidUpdate","prevProps","setData","componentDidMount","gradientColor","select","ios","android","web","gradientContainerStyle","state","selectedStyle","height","borderColor","styles","gradientContainer","handleOnSelect","onChange","haptics","Math","abs","userTouch","impactAsync","ImpactFeedbackStyle","Light","setState","item","additionalItem","label","value","render","width","initialSelectedIndex","flatListProps","_","toString","options","PickerItem","listItem","fontSize","handleOnPressItem","renderItem","e","onTouchStart","event","round","nativeEvent","contentOffset","y","offset","topGradient","borderBottomWidth","borderWidth","linearGradient","bottomGradient","borderTopWidth","Item","memo","fontColor","textAlign","color","indexSelected","style","onPress","gap","sizeText","create","alignItems","justifyContent","position","flex","top","bottom"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport {\n  FlatList,\n  Text,\n  StyleSheet,\n  View,\n  Platform,\n  TouchableOpacity,\n} from 'react-native';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { adaptiveColor, setAlphaColor } from './util';\nimport type {\n  ItemType,\n  IViuPickerProps,\n  IViuPickerState,\n  RenderItemProps,\n} from './types';\nimport * as Haptics from 'expo-haptics';\n\nclass WheelPickerExpo extends PureComponent<IViuPickerProps, IViuPickerState> {\n  static defaultProps = {\n    items: [],\n    backgroundColor: '#FFFFFF',\n    width: 150,\n    haptics: false,\n  };\n\n  flatListRef = React.createRef<FlatList>();\n  backgroundColor = setAlphaColor(this.props.backgroundColor as any, 1);\n\n  state = {\n    selectedIndex: 0,\n    itemHeight: 40,\n    listHeight: 200,\n    data: [],\n  };\n\n  userTouch = false;\n\n  componentDidUpdate(prevProps: IViuPickerProps) {\n    if (this.props.items?.length !== prevProps.items?.length) {\n      this.setData();\n    }\n  }\n\n  componentDidMount() {\n    this.setData();\n  }\n\n  get gradientColor(): string {\n    return Platform.select({\n      ios: setAlphaColor(this.backgroundColor, 0.2),\n      android: setAlphaColor(this.backgroundColor, 0.4),\n      web: setAlphaColor(this.backgroundColor, 0.4),\n    }) as string;\n  }\n\n  get gradientContainerStyle() {\n    const { itemHeight } = this.state;\n    const { selectedStyle } = this.props;\n\n    return [\n      { height: 2 * itemHeight, borderColor: selectedStyle?.borderColor },\n      styles.gradientContainer,\n    ];\n  }\n\n  handleOnSelect(index: number) {\n    const { items, onChange, haptics } = this.props;\n    const selectedIndex = Math.abs(index);\n\n    if (selectedIndex >= 0 && selectedIndex <= items.length - 1) {\n      if (\n        haptics &&\n        this.userTouch &&\n        this.state.selectedIndex !== selectedIndex\n      ) {\n        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n      }\n\n      this.setState({ selectedIndex });\n      onChange &&\n        onChange({ index: selectedIndex, item: items[selectedIndex] });\n    }\n  }\n\n  handleOnPressItem = (index: number) => {\n    if (index >= 0 && index <= this.props.items.length - 1) {\n      this.flatListRef.current?.scrollToIndex({\n        animated: true,\n        index: index,\n      });\n    }\n  };\n\n  setData() {\n    let { itemHeight, listHeight } = this.state;\n    const { items, height } = this.props;\n\n    if (items?.length) {\n      const additionalItem = { label: '', value: null };\n      const data = [\n        additionalItem,\n        additionalItem,\n        ...items,\n        additionalItem,\n        additionalItem,\n      ] as ItemType[];\n\n      if (height) {\n        listHeight = height;\n        itemHeight = listHeight / 5;\n      }\n\n      this.setState({ data, itemHeight, listHeight });\n    }\n  }\n\n  render() {\n    const { data, itemHeight, listHeight, selectedIndex } = this.state;\n    const { width, initialSelectedIndex, flatListProps, selectedStyle } =\n      this.props;\n\n    if (!data.length) return;\n\n    return (\n      <View\n        style={{\n          height: listHeight,\n          width,\n          backgroundColor: this.backgroundColor,\n        }}\n      >\n        <FlatList\n          keyExtractor={(_, index) => index.toString()}\n          showsVerticalScrollIndicator={false}\n          renderItem={(options) =>\n            PickerItem(\n              options,\n              selectedIndex,\n              {\n                ...styles.listItem,\n                backgroundColor: this.backgroundColor,\n                fontSize: itemHeight / 2,\n                height: itemHeight,\n              },\n              this.handleOnPressItem,\n              this.props.renderItem as any\n            )\n          }\n          {...flatListProps}\n          onTouchStart={(e) => {\n            this.userTouch = true;\n            !!flatListProps?.onTouchStart && flatListProps.onTouchStart(e);\n          }}\n          ref={this.flatListRef}\n          initialScrollIndex={initialSelectedIndex}\n          data={data}\n          onScroll={(event) => {\n            let index = Math.round(\n              event.nativeEvent.contentOffset.y / itemHeight\n            );\n            this.handleOnSelect(index);\n          }}\n          getItemLayout={(_, index) => ({\n            length: itemHeight,\n            offset: index * itemHeight,\n            index,\n          })}\n          snapToInterval={itemHeight}\n        />\n        <View\n          style={[\n            this.gradientContainerStyle,\n            styles.topGradient,\n            { borderBottomWidth: selectedStyle?.borderWidth },\n          ]}\n          pointerEvents=\"none\"\n        >\n          <LinearGradient\n            style={styles.linearGradient}\n            colors={[this.backgroundColor, this.gradientColor]}\n          />\n        </View>\n        <View\n          style={[\n            this.gradientContainerStyle,\n            styles.bottomGradient,\n            { borderTopWidth: selectedStyle?.borderWidth },\n          ]}\n          pointerEvents=\"none\"\n        >\n          <LinearGradient\n            style={styles.linearGradient}\n            colors={[this.gradientColor, this.backgroundColor]}\n          />\n        </View>\n      </View>\n    );\n  }\n}\n\nconst Item = React.memo(\n  ({ fontSize, label, fontColor, textAlign }: RenderItemProps) => (\n    <Text style={{ fontSize, color: fontColor, textAlign }}>{label}</Text>\n  )\n);\n\nconst PickerItem = (\n  { item, index }: any,\n  indexSelected: number,\n  style: any,\n  onPress: (index: number) => void,\n  renderItem: (props: RenderItemProps) => JSX.Element\n) => {\n  const gap = Math.abs(index - (indexSelected + 2));\n  const sizeText = [style.fontSize, style.fontSize / 1.5, style.fontSize / 2];\n\n  const fontSize = gap > 1 ? sizeText[2] : sizeText[gap];\n  const fontColor = adaptiveColor(style.backgroundColor);\n  const textAlign = 'center';\n\n  return (\n    <TouchableOpacity activeOpacity={1} onPress={() => onPress(index - 2)}>\n      <View style={style}>\n        {typeof renderItem === 'function' &&\n          renderItem({ fontSize, fontColor, label: item.label, textAlign })}\n        {!renderItem && (\n          <Item\n            fontSize={fontSize}\n            fontColor={fontColor}\n            textAlign={textAlign}\n            label={item.label}\n          />\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n};\n\nconst styles = StyleSheet.create({\n  listItem: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  gradientContainer: {\n    position: 'absolute',\n    width: '100%',\n  },\n  linearGradient: { flex: 1 },\n  topGradient: { top: 0 },\n  bottomGradient: { bottom: 0 },\n});\n\nexport default WheelPickerExpo;\n"]}